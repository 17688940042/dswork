<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC
	"-//ibatis.apache.org//DTD Mapper 3.0//EN" 
	"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<mapper namespace="dswork.bbs.model.DsBbsPage">

	<insert id="insert" parameterType="dswork.bbs.model.DsBbsPage">
		<selectKey resultType="Long" order="AFTER" keyProperty="id">
			select LAST_INSERT_ID()
		</selectKey>
		insert into DS_BBS_PAGE
		(ID, SITEID, FORUMID, USERID, TITLE, URL, SUMMARY, ISESSENCE, ISTOP, METAKEYWORDS, METADESCRIPTION, RELEASEUSER, RELEASETIME, OVERTIME, LASTUSER, LASTTIME, NUMPV, NUMHT, CONTENT)
		values
		(null, #{siteid}, #{forumid}, #{userid}, #{title}, #{url}, #{summary}, #{isessence}, #{istop}, #{metakeywords}, #{metadescription}, #{releaseuser}, #{releasetime}, #{overtime}, #{lastuser}, #{lasttime}, #{numpv}, #{numht}, #{content})
	</insert>

	<delete id="delete">
		delete from DS_BBS_PAGE where ID=#{id}
	</delete>

	<update id="update" parameterType="dswork.bbs.model.DsBbsPage">
		update DS_BBS_PAGE set
			SITEID=#{siteid},
			FORUMID=#{forumid},
			USERID=#{userid},
			TITLE=#{title},
			URL=#{url},
			SUMMARY=#{summary},
			ISESSENCE=#{isessence},
			ISTOP=#{istop},
			METAKEYWORDS=#{metakeywords},
			METADESCRIPTION=#{metadescription},
			RELEASEUSER=#{releaseuser},
			RELEASETIME=#{releasetime},
			OVERTIME=#{overtime},
			LASTUSER=#{lastuser},
			LASTTIME=#{lasttime},
			NUMPV=#{numpv},
			NUMHT=#{numht},
			CONTENT=#{content}
		where ID=#{id}
	</update>

	<resultMap id="result" type="dswork.bbs.model.DsBbsPage">
		<id property="id" column="ID" />
		<result property="siteid" column="SITEID" />
		<result property="forumid" column="FORUMID" />
		<result property="userid" column="USERID" />
		<result property="title" column="TITLE" />
		<result property="url" column="URL" />
		<result property="summary" column="SUMMARY" />
		<result property="isessence" column="ISESSENCE" />
		<result property="istop" column="ISTOP" />
		<result property="metakeywords" column="METAKEYWORDS" />
		<result property="metadescription" column="METADESCRIPTION" />
		<result property="releaseuser" column="RELEASEUSER" />
		<result property="releasetime" column="RELEASETIME" />
		<result property="overtime" column="OVERTIME" />
		<result property="lastuser" column="LASTUSER" />
		<result property="lasttime" column="LASTTIME" />
		<result property="numpv" column="NUMPV" />
		<result property="numht" column="NUMHT" />
		<result property="content" column="CONTENT" />
	</resultMap>

	<sql id="columns">
		ID, SITEID, FORUMID, USERID, TITLE, URL, SUMMARY, ISESSENCE, ISTOP, METAKEYWORDS, METADESCRIPTION, RELEASEUSER, RELEASETIME, OVERTIME, LASTUSER, LASTTIME, NUMPV, NUMHT, CONTENT
	</sql>
	
	<sql id="dynamicWhere">
		<where>
			<if test="@Ognl@isNotEmpty(siteid)"> and SITEID like concat('%',#{siteid},'%') </if>
			<if test="@Ognl@isNotEmpty(forumid)"> and FORUMID like concat('%',#{forumid},'%') </if>
			<if test="@Ognl@isNotEmpty(userid)"> and USERID like concat('%',#{userid},'%') </if>
			<if test="@Ognl@isNotEmpty(title)"> and TITLE like concat('%',#{title},'%') </if>
			<if test="@Ognl@isNotEmpty(url)"> and URL like concat('%',#{url},'%') </if>
			<if test="@Ognl@isNotEmpty(summary)"> and SUMMARY like concat('%',#{summary},'%') </if>
			<if test="@Ognl@isNotEmpty(isessence)"> and ISESSENCE like concat('%',#{isessence},'%') </if>
			<if test="@Ognl@isNotEmpty(istop)"> and ISTOP like concat('%',#{istop},'%') </if>
			<if test="@Ognl@isNotEmpty(metakeywords)"> and METAKEYWORDS like concat('%',#{metakeywords},'%') </if>
			<if test="@Ognl@isNotEmpty(metadescription)"> and METADESCRIPTION like concat('%',#{metadescription},'%') </if>
			<if test="@Ognl@isNotEmpty(releaseuser)"> and RELEASEUSER like concat('%',#{releaseuser},'%') </if>
			<if test="@Ognl@isNotEmpty(releasetime)"> and RELEASETIME like concat('%',#{releasetime},'%') </if>
			<if test="@Ognl@isNotEmpty(overtime)"> and OVERTIME like concat('%',#{overtime},'%') </if>
			<if test="@Ognl@isNotEmpty(lastuser)"> and LASTUSER like concat('%',#{lastuser},'%') </if>
			<if test="@Ognl@isNotEmpty(lasttime)"> and LASTTIME like concat('%',#{lasttime},'%') </if>
			<if test="@Ognl@isNotEmpty(numpv)"> and NUMPV like concat('%',#{numpv},'%') </if>
			<if test="@Ognl@isNotEmpty(numht)"> and NUMHT like concat('%',#{numht},'%') </if>
			<if test="@Ognl@isNotEmpty(content)"> and CONTENT like concat('%',#{content},'%') </if>
		</where>
	</sql>

	<select id="select" resultMap="result">
		select <include refid="columns" /> from DS_BBS_PAGE where ID=#{id}
	</select>

	<select id="query" resultMap="result">
		select <include refid="columns" /> from DS_BBS_PAGE
		<include refid="dynamicWhere" />
	</select>

	<select id="queryCount" resultType="int">
		select count(1) from DS_BBS_PAGE
		<include refid="dynamicWhere" />
	</select>

</mapper>
