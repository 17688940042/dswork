<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC
	"-//ibatis.apache.org//DTD Mapper 3.0//EN" 
	"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<mapper namespace="dswork.ep.model.DsEpUser">

	<insert id="insert" parameterType="dswork.ep.model.DsEpUser">
		<selectKey resultType="Long" order="AFTER" keyProperty="id">
			select LAST_INSERT_ID()
		</selectKey>
		insert into DS_EP_USER
		(ID, QYBM, ACCOUNT, PASSWORD, NAME, IDCARD, STATUS, EMAIL, MOBILE, PHONE, WORKCARD, CAKEY, CREATETIME, SSDW, SSBM, FAX)
		values
		(null, #{qybm}, #{account}, #{password}, #{name}, #{idcard}, #{status}, #{email}, #{mobile}, #{phone}, #{workcard}, #{cakey}, #{createtime}, #{ssdw}, #{ssbm}, #{fax})
	</insert>

	<delete id="delete">
		delete from DS_EP_USER where ID=#{id}
	</delete>

	<update id="update" parameterType="dswork.ep.model.DsEpUser">
		update DS_EP_USER set
			ACCOUNT=#{account},
			PASSWORD=#{password},
			NAME=#{name},
			IDCARD=#{idcard},
			STATUS=#{status},
			EMAIL=#{email},
			MOBILE=#{mobile},
			PHONE=#{phone},
			WORKCARD=#{workcard},
			CAKEY=#{cakey},
			CREATETIME=#{createtime},
			SSDW=#{ssdw},
			SSBM=#{ssbm},
			FAX=#{fax}
		where ID=#{id}
	</update>

	<resultMap id="result" type="dswork.ep.model.DsEpUser">
		<id property="id" column="ID" />
		<result property="qybm" column="QYBM" />
		<result property="account" column="ACCOUNT" />
		<result property="password" column="PASSWORD" />
		<result property="name" column="NAME" />
		<result property="idcard" column="IDCARD" />
		<result property="status" column="STATUS" />
		<result property="email" column="EMAIL" />
		<result property="mobile" column="MOBILE" />
		<result property="phone" column="PHONE" />
		<result property="workcard" column="WORKCARD" />
		<result property="cakey" column="CAKEY" />
		<result property="createtime" column="CREATETIME" />
		<result property="ssdw" column="SSDW" />
		<result property="ssbm" column="SSBM" />
		<result property="fax" column="FAX" />
	</resultMap>

	<sql id="columns">
		ID, QYBM, ACCOUNT, PASSWORD, NAME, IDCARD, STATUS, EMAIL, MOBILE, PHONE, WORKCARD, CAKEY, CREATETIME, SSDW, SSBM, FAX
	</sql>
	
	<sql id="dynamicWhere">
		<where>
			<if test="@Ognl@isNotEmpty(qybm)"> and QYBM=#{qybm} </if>
			<if test="@Ognl@isNotEmpty(account)"> and ACCOUNT=#{account} </if>
			<if test="@Ognl@isNotEmpty(name)"> and NAME like concat('%',#{name},'%') </if>
			<if test="@Ognl@isNotEmpty(idcard)"> and IDCARD like concat('%',#{idcard},'%') </if>
			<if test="@Ognl@isNotEmpty(status)"> and STATUS like concat('%',#{status},'%') </if>
			<if test="@Ognl@isNotEmpty(email)"> and EMAIL like concat('%',#{email},'%') </if>
			<if test="@Ognl@isNotEmpty(mobile)"> and MOBILE like concat('%',#{mobile},'%') </if>
			<if test="@Ognl@isNotEmpty(phone)"> and PHONE like concat('%',#{phone},'%') </if>
			<if test="@Ognl@isNotEmpty(workcard)"> and WORKCARD like concat('%',#{workcard},'%') </if>
			<if test="@Ognl@isNotEmpty(cakey)"> and CAKEY like concat('%',#{cakey},'%') </if>
			<if test="@Ognl@isNotEmpty(createtime)"> and CREATETIME like concat('%',#{createtime},'%') </if>
			<if test="@Ognl@isNotEmpty(ssdw)"> and SSDW like concat('%',#{ssdw},'%') </if>
			<if test="@Ognl@isNotEmpty(ssbm)"> and SSBM like concat('%',#{ssbm},'%') </if>
			<if test="@Ognl@isNotEmpty(fax)"> and FAX like concat('%',#{fax},'%') </if>
		</where>
	</sql>

	<select id="getUserByAccount" resultMap="result">
		select <include refid="columns" /> from DS_EP_USER where ACCOUNT=#{account}
	</select>

	<select id="select" resultMap="result">
		select <include refid="columns" /> from DS_EP_USER where ID=#{id}
	</select>

	<select id="query" resultMap="result">
		select <include refid="columns" /> from DS_EP_USER
		<include refid="dynamicWhere" />
	</select>

	<select id="queryCount" resultType="int">
		select count(1) from DS_EP_USER
		<include refid="dynamicWhere" />
	</select>

</mapper>
